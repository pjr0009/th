!!! 5
%html{lang: "en", "ng-app": "TackHunter", "ng-controller": "TackHunterCtrl", "xmlns:ng": "http://angularjs.org"}
  = render :partial => 'layouts/head'
  %body.layout-column
    = render partial: 'layouts/global_header', locals: header_props()
    - if content_for?(:sidenav_left)
      - @layout_classes = "layout-row flex"
    - else
      - @layout_classes = ""
    %div{class: "#{@layout_classes}"}
      - if content_for?(:sidenav_left)
        %md-sidenav.ng-cloak.layout-column.bg-body.md-sidenav-left.md-locked-open{"md-is-locked-open": "$mdMedia('gt-sm')", "md-component-id": "left"}
          = yield :sidenav_left
      - else
      %md-content.layout-column.layout-fill.flex.bg-body
        -# Render railsContext here before any react component gets rendered
        = prepend_render_rails_context("")
        - if content_for?(:hero)
          %header.hero
            = yield :hero

        = render :partial => "layouts/notifications"
        = yield

        
        -# Most of the JavaScript should be for performance reasons at the end of the body

        -# load Facebook SDK for the whole page
        = render :partial => "layouts/facebook_sdk"

        -# Initialize global I18n variable and load translations there
        :javascript
          window.I18n = {};

        = javascript_include_tag "i18n/#{I18n.locale}"

        = javascript_include_tag 'application'

        :javascript
          window.ST.jsonTranslations = #{JSONTranslations.get(I18n.locale)}

        - if @analytics_event
          :javascript
            report_analytics_event.apply(null, #{@analytics_event});
        - if @gtm_datalayer
          :javascript
            if(window.ST != null && typeof window.ST.gtmPush === 'function') {
              window.ST.gtmPush(#{@gtm_datalayer.to_json});
            }

        :javascript
          $(function() {
            if ('touchAction' in document.body.style) {
              document.body.style.touchAction = 'manipulation';
            } else {
              window.FastClick.attach(document.body, { excludeNode: '^pac-'} );
            }
          });

        -# Disable animations on tests
        - if Rails.env.test?
          :javascript
            $(function() {
              $.transit.enabled = false;
            });

        = content_for :extra_javascript

        :javascript
          $(document).ready(function() { initialize_defaults("#{I18n.locale}"); #{yield :javascript} });

  = render partial: "layouts/footer"


